<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AnimeGOLD - Premium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        body {
            background: #0a0a0a;
            color: #fff;
        }
        .gold {
            color: #FFD700;
        }
        .bg-gold {
            background: #FFD700;
            color: #000;
        }
        .app-wrapper {
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            width: 260px;
            background: #111;
            border-right: 1px solid #FFD70033;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }
        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid #FFD70033;
            margin-bottom: 20px;
        }
        .sidebar-header .logo {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        .sidebar-header .logo .gold {
            color: #FFD700;
        }
        .sidebar-header .logo .white {
            color: #ffffff;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #FFD700;
        }
        .user-info i {
            font-size: 32px;
            color: #FFD700;
        }
        .user-info .username {
            font-weight: bold;
            color: #FFD700;
        }
        .sidebar-menu {
            flex: 1;
            padding: 0 10px;
        }
        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            margin: 4px 0;
            border-radius: 30px;
            color: #ddd;
            transition: 0.2s;
            cursor: pointer;
        }
        .menu-item i {
            width: 24px;
            color: #FFD700;
        }
        .menu-item:hover, .menu-item.active {
            background: #FFD70022;
            color: #FFD700;
        }
        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid #FFD70033;
        }
        .logout-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #ff6b6b;
            padding: 12px 20px;
            border-radius: 30px;
            cursor: pointer;
        }
        .logout-btn:hover {
            background: #ff6b6b22;
        }
        .main-content {
            flex: 1;
            background: #0a0a0a;
            overflow-x: hidden;
        }
        .mobile-nav {
            display: none;
            background: #111;
            padding: 10px 20px;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #FFD70033;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .mobile-nav .menu-toggle {
            font-size: 24px;
            color: #FFD700;
            cursor: pointer;
        }
        .mobile-nav .logo {
            font-size: 22px;
            font-weight: bold;
        }
        .mobile-nav .logo .gold {
            color: #FFD700;
        }
        .mobile-nav .logo .white {
            color: #ffffff;
        }
        .mobile-nav .search-box {
            display: flex;
            background: #222;
            border-radius: 30px;
            overflow: hidden;
            border: 1px solid #FFD700;
        }
        .mobile-nav .search-box input {
            background: transparent;
            border: none;
            padding: 8px 12px;
            color: white;
            outline: none;
            width: 180px;
        }
        .mobile-nav .search-box button {
            background: #FFD700;
            border: none;
            padding: 8px 15px;
            cursor: pointer;
            color: #000;
        }
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 200;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .shimmer-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        .shimmer-card {
            width: 180px;
            height: 260px;
            background: linear-gradient(90deg, #1f1f1f 25%, #2a2a2a 50%, #1f1f1f 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: 8px;
        }
        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 30px 0 20px;
            color: #FFD700;
            font-size: 20px;
            font-weight: bold;
        }
        .anime-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .anime-card {
            background: #1f1f1f;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .anime-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }
        .anime-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 2px solid #FFD700;
        }
        .anime-card .info {
            padding: 10px;
        }
        .anime-card .title {
            color: #FFD700;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .anime-card .meta {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #aaa;
        }
        .search-item {
            background: #1f1f1f;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
            display: flex;
            gap: 15px;
            cursor: pointer;
        }
        .search-item img {
            width: 80px;
            height: 120px;
            object-fit: cover;
            border-radius: 4px;
        }
        .search-item .title {
            color: #FFD700;
            font-size: 16px;
            font-weight: bold;
        }
        .genre-tag {
            background: #2a2a2a;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            color: #FFD700;
            display: inline-block;
            margin-right: 5px;
            margin-bottom: 5px;
            cursor: pointer;
        }
        .detail-header {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .detail-poster {
            width: 250px;
            border-radius: 8px;
            border: 2px solid #FFD700;
        }
        .detail-info h1 {
            color: #FFD700;
            font-size: 28px;
        }
        .detail-meta {
            background: #1f1f1f;
            padding: 15px;
            border-radius: 8px;
            display: grid;
            grid-template-columns: repeat(2,1fr);
            gap: 10px;
        }
        .detail-meta-item .label {
            color: #aaa;
        }
        .detail-meta-item .value {
            color: #FFD700;
            font-weight: bold;
            margin-left: 5px;
        }
        .synopsis {
            background: #1f1f1f;
            padding: 20px;
            border-radius: 8px;
            line-height: 1.6;
        }
        .episode-item {
            background: #1f1f1f;
            padding: 12px 15px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            cursor: pointer;
            margin-bottom: 8px;
        }
        .episode-item:hover {
            background: #2a2a2a;
        }
        .episode-number {
            background: #FFD700;
            color: #000;
            font-weight: bold;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            margin-right: 15px;
        }
        .player-container {
            background: #000;
            width: 100%;
            aspect-ratio: 16/9;
        }
        .player-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .bottom-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #111;
            border-top: 1px solid #FFD70033;
            padding: 8px 0;
            justify-content: space-around;
            z-index: 100;
        }
        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #aaa;
            font-size: 12px;
            cursor: pointer;
            padding: 5px 0;
            flex: 1;
        }
        .bottom-nav-item i {
            font-size: 20px;
            margin-bottom: 2px;
        }
        .bottom-nav-item.active {
            color: #FFD700;
        }
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                z-index: 300;
                transform: translateX(-100%);
                box-shadow: 2px 0 10px rgba(0,0,0,0.5);
            }
            .sidebar.open {
                transform: translateX(0);
            }
            .mobile-nav {
                display: flex;
            }
            .sidebar-overlay.active {
                display: block;
            }
            .app-wrapper {
                display: block;
            }
            .bottom-nav {
                display: flex;
            }
            .container {
                padding-bottom: 70px;
            }
        }
    </style>
<script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>
    
</head>
<body>
    <amp-auto-ads type="adsense"
        data-ad-client="ca-pub-2248811225701494">
</amp-auto-ads>
    <div class="app-wrapper">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="gold">Anime</span><span class="white">GOLD</span>
                </div>
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span class="username" id="sidebarUsername">Loading...</span>
                </div>
            </div>
            <div class="sidebar-menu">
                <div class="menu-item active" onclick="https://homeanime.vercel.app">
                    <i class="fas fa-home"></i> Home
                </div>
                <div class="menu-item" onclick="navigateTo('schedule'); setActiveMenu(this)">
                    <i class="fas fa-calendar-alt"></i> Jadwal
                </div>
                <div class="menu-item" onclick="navigateTo('genres'); setActiveMenu(this)">
                    <i class="fas fa-tags"></i> Genre
                </div>
                
            </div>
            </div>
        </div>

        <!-- Overlay untuk mobile -->
        <div class="sidebar-overlay" id="overlay" onclick="toggleSidebar()"></div>

        <!-- Konten utama -->
        <div class="main-content">
            <!-- Navbar mobile dengan search -->
            <div class="mobile-nav">
                <div class="menu-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </div>
                <div class="logo">
                    <span class="gold">Anime</span><span class="white">GOLD</span>
                </div>
                <div class="search-box">
                    <input type="text" id="mobileSearch" placeholder="Cari anime..." onkeypress="if(event.key==='Enter') searchMobile()">
                    <button onclick="searchMobile()"><i class="fas fa-search"></i></button>
                </div>
            </div>

            <!-- Container konten dinamis -->
            <div id="content" class="container">
                <!-- Diisi JavaScript -->
            </div>

            <!-- Bottom Navigation untuk mobile -->
            <div class="bottom-nav">
                <div class="bottom-nav-item active" onclick="navigateTo('home'); setActiveBottom(this)">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </div>
                <div class="bottom-nav-item" onclick="navigateTo('schedule'); setActiveBottom(this)">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Jadwal</span>
                </div>
                <div class="bottom-nav-item" onclick="navigateTo('genres'); setActiveBottom(this)">
                    <i class="fas fa-tags"></i>
                    <span>Genre</span>
                </div>
                <div class="bottom-nav-item" onclick="navigateTo('history'); setActiveBottom(this)">
                    <i class="fas fa-history"></i>
                    <span>History</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== STATE ====================
        const BASE_URL = 'https://www.sankavollerei.com/anime';
        let currentPage = 'home';
        let currentSlug = null;
        let watchHistory = [];

        // Ambil username dari localStorage (misal disimpan saat login)
        let currentUsername = localStorage.getItem('username') || 'GoldUser';
        document.getElementById('sidebarUsername').innerText = currentUsername;

        // Load history
        function loadHistory() {
            const stored = localStorage.getItem('goldAnimeHistory');
            if (stored) {
                try {
                    watchHistory = JSON.parse(stored);
                } catch { watchHistory = []; }
            } else watchHistory = [];
        }
        function saveHistory() {
            localStorage.setItem('goldAnimeHistory', JSON.stringify(watchHistory.slice(0, 30)));
        }
        function addToHistory(animeSlug, animeTitle, animePoster, episodeSlug, episodeTitle) {
            loadHistory();
            watchHistory = watchHistory.filter(item => !(item.animeSlug === animeSlug && item.episodeSlug === episodeSlug));
            watchHistory.unshift({ animeSlug, animeTitle, animePoster, episodeSlug, episodeTitle, time: Date.now() });
            saveHistory();
        }

        // ==================== UI UTILITY ====================
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('overlay').classList.toggle('active');
        }

        function setActiveMenu(el) {
            document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
            el.classList.add('active');
            if (window.innerWidth <= 768) toggleSidebar();
        }

        function setActiveBottom(el) {
            document.querySelectorAll('.bottom-nav-item').forEach(item => item.classList.remove('active'));
            el.classList.add('active');
        }

        function logout() {
            // Panggil endpoint /logout (misal GET)
            fetch('/logout', { method: 'POST', credentials: 'same-origin' })
                .then(() => {
                    localStorage.removeItem('username');
                    localStorage.removeItem('goldAnimeHistory');
                    window.location.href = '/home.html'; // redirect ke halaman login/home
                })
                .catch(() => {
                    // Fallback: hapus localStorage dan redirect
                    localStorage.clear();
                    window.location.href = '/home.html';
                });
        }

        function searchMobile() {
            const query = document.getElementById('mobileSearch').value.trim();
            if (query) navigateTo('search', { query });
        }

        // ==================== NAVIGASI ====================
        function navigateTo(page, params = {}) {
            currentPage = page;
            
            // Update active states
            document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.bottom-nav-item').forEach(item => item.classList.remove('active'));
            
            if (page === 'home') {
                document.querySelector('.menu-item[onclick*="home"]')?.classList.add('active');
                document.querySelectorAll('.bottom-nav-item')[0]?.classList.add('active');
                renderHome();
            } else if (page === 'search') {
                renderSearch(params.query);
            } else if (page === 'detail') {
                renderDetail(params.slug);
            } else if (page === 'episode') {
                renderEpisode(params.episodeSlug, params.animeSlug);
            } else if (page === 'genres') {
                document.querySelector('.menu-item[onclick*="genres"]')?.classList.add('active');
                document.querySelectorAll('.bottom-nav-item')[2]?.classList.add('active');
                renderGenreList();
            } else if (page === 'genre') {
                renderGenreDetail(params.genreSlug, params.genreName);
            } else if (page === 'schedule') {
                document.querySelector('.menu-item[onclick*="schedule"]')?.classList.add('active');
                document.querySelectorAll('.bottom-nav-item')[1]?.classList.add('active');
                renderSchedule();
            } else if (page === 'history') {
                document.querySelector('.menu-item[onclick*="history"]')?.classList.add('active');
                document.querySelectorAll('.bottom-nav-item')[3]?.classList.add('active');
                renderHistory();
            }
            
            window.location.hash = page + (params.slug ? '/' + params.slug : '');
        }

        // Handle hash
        window.addEventListener('load', () => {
            const hash = window.location.hash.substring(1);
            if (hash.startsWith('home')) navigateTo('home');
            else if (hash.startsWith('detail/')) navigateTo('detail', { slug: hash.split('/')[1] });
            else if (hash.startsWith('episode/')) {
                const parts = hash.split('/');
                navigateTo('episode', { episodeSlug: parts[1], animeSlug: parts[2] });
            }
            else if (hash.startsWith('genre/')) {
                const parts = hash.split('/');
                navigateTo('genre', { genreSlug: parts[1], genreName: decodeURIComponent(parts[2]) });
            }
            else if (hash.startsWith('genres')) navigateTo('genres');
            else if (hash.startsWith('schedule')) navigateTo('schedule');
            else if (hash.startsWith('history')) navigateTo('history');
            else navigateTo('home');
        });

        // ==================== API FETCH ====================
        async function fetchAPI(endpoint) {
            try {
                const res = await fetch(BASE_URL + endpoint);
                if (!res.ok) throw new Error();
                const json = await res.json();
                return json.data || json;
            } catch (e) {
                return null;
            }
        }

        // ==================== RENDER HOME ====================
        async function renderHome() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="shimmer-wrapper">'.repeat(8) + '</div>';
            const data = await fetchAPI('/home');
            if (!data) {
                content.innerHTML = '<p>Gagal memuat</p>';
                return;
            }

            loadHistory();
            let html = '';

            if (watchHistory.length) {
                html += '<div class="section-header"><i class="fas fa-history gold"></i> Watch History</div>';
                html += '<div class="anime-grid">';
                watchHistory.slice(0, 6).forEach(item => {
                    html += `
                        <div class="anime-card" onclick="navigateTo('episode', { episodeSlug: '${item.episodeSlug}', animeSlug: '${item.animeSlug}' })">
                            <img src="${item.animePoster}" alt="${item.animeTitle}">
                            <div class="info">
                                <div class="title">${item.animeTitle}</div>
                                <div class="meta">${item.episodeTitle || 'Episode'}</div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }

            html += '<div class="section-header"><i class="fas fa-bolt gold"></i> Quick Access</div>';
            html += '<div style="display:flex; gap:20px; margin-bottom:30px;">';
            html += '<div class="anime-card" style="flex:1;" onclick="navigateTo(\'genres\')"><div style="padding:30px; text-align:center;"><i class="fas fa-tags" style="font-size:40px; color:gold;"></i><br>Genre</div></div>';
            html += '<div class="anime-card" style="flex:1;" onclick="navigateTo(\'schedule\')"><div style="padding:30px; text-align:center;"><i class="fas fa-calendar" style="font-size:40px; color:gold;"></i><br>Jadwal</div></div>';
            html += '</div>';

            html += '<div class="section-header"><i class="fas fa-play-circle gold"></i> Ongoing</div>';
            html += '<div class="anime-grid">';
            data.ongoing?.animeList?.forEach(anime => {
                html += `<div class="anime-card" onclick="navigateTo('detail', { slug: '${anime.animeId}' })">
                    <img src="${anime.poster}" loading="lazy">
                    <div class="info"><div class="title">${anime.title}</div><div class="meta">${anime.episodes || '?'} eps</div></div>
                </div>`;
            });
            html += '</div>';

            html += '<div class="section-header"><i class="fas fa-check-circle gold"></i> Completed</div>';
            html += '<div class="anime-grid">';
            data.completed?.animeList?.forEach(anime => {
                html += `<div class="anime-card" onclick="navigateTo('detail', { slug: '${anime.animeId}' })">
                    <img src="${anime.poster}" loading="lazy">
                    <div class="info"><div class="title">${anime.title}</div><div class="meta">${anime.episodes || '?'} eps</div></div>
                </div>`;
            });
            html += '</div>';

            content.innerHTML = html;
        }

        // ==================== SEARCH ====================
        async function renderSearch(query) {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="shimmer-wrapper"></div>';
            const data = await fetchAPI('/search/' + encodeURIComponent(query));
            if (!data?.animeList) {
                content.innerHTML = '<p>Tidak ditemukan</p>';
                return;
            }
            let html = '<div class="section-header"><i class="fas fa-search gold"></i> Hasil: ' + query + '</div>';
            data.animeList.forEach(anime => {
                html += `
                    <div class="search-item" onclick="navigateTo('detail', { slug: '${anime.animeId}' })">
                        <img src="${anime.poster}">
                        <div class="info">
                            <div class="title">${anime.title}</div>
                            <div>${anime.genreList?.map(g => `<span class="genre-tag">${g.title}</span>`).join('')}</div>
                        </div>
                    </div>
                `;
            });
            content.innerHTML = html;
        }

        // ==================== DETAIL ====================
        async function renderDetail(slug) {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="shimmer-wrapper"></div>';
            const anime = await fetchAPI('/anime/' + slug);
            if (!anime) {
                content.innerHTML = '<p>Gagal</p>';
                return;
            }

            let html = `
                <div class="detail-header">
                    <img class="detail-poster" src="${anime.poster}">
                    <div class="detail-info">
                        <h1>${anime.title}</h1>
                        <div class="detail-meta">
                            <div><span class="label">Tipe:</span><span class="value">${anime.type || '-'}</span></div>
                            <div><span class="label">Status:</span><span class="value">${anime.status || '-'}</span></div>
                            <div><span class="label">Episode:</span><span class="value">${anime.episodes || '-'}</span></div>
                            <div><span class="label">Skor:</span><span class="value">${anime.score || '-'}</span></div>
                        </div>
                        <div style="margin-top:10px;">
                            ${anime.genreList?.map(g => `<span class="genre-tag" onclick="navigateTo('genre', { genreSlug: '${g.genreId}', genreName: '${g.title}' })">${g.title}</span>`).join('')}
                        </div>
                    </div>
                </div>
                <div class="synopsis">${anime.synopsis?.paragraphs?.join('<br><br>') || 'Tidak ada sinopsis.'}</div>
            `;

            if (anime.episodeList?.length) {
                html += '<div class="section-header"><i class="fas fa-list gold"></i> Episode</div>';
                html += '<div class="episode-list">';
                anime.episodeList.forEach(ep => {
                    html += `
                        <div class="episode-item" onclick="navigateTo('episode', { episodeSlug: '${ep.episodeId}', animeSlug: '${slug}' })">
                            <div class="episode-number">${ep.eps}</div>
                            <div class="episode-title">${ep.title}</div>
                            <i class="fas fa-play" style="color:gold; margin-left:auto;"></i>
                        </div>
                    `;
                });
                html += '</div>';
            }

            if (anime.batch) {
                html += `<div class="episode-item" onclick="window.open('${anime.batch.otakudesuUrl}','_blank')"><i class="fas fa-download gold" style="margin-right:10px;"></i> Download Batch: ${anime.batch.title}</div>`;
            }

            if (anime.recommendedAnimeList?.length) {
                html += '<div class="section-header"><i class="fas fa-thumbs-up gold"></i> Rekomendasi</div>';
                html += '<div class="anime-grid">';
                anime.recommendedAnimeList.forEach(rec => {
                    html += `<div class="anime-card" onclick="navigateTo('detail', { slug: '${rec.animeId}' })"><img src="${rec.poster}"><div class="info"><div class="title">${rec.title}</div></div></div>`;
                });
                html += '</div>';
            }

            content.innerHTML = html;
        }

        // ==================== EPISODE ====================
        async function renderEpisode(episodeSlug, animeSlug) {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="shimmer-wrapper"></div>';
            const episode = await fetchAPI('/episode/' + episodeSlug);
            const anime = animeSlug ? await fetchAPI('/anime/' + animeSlug) : null;
            if (!episode) {
                content.innerHTML = '<p>Gagal</p>';
                return;
            }

            let streamUrl = '';
            const qualities = episode.server?.qualities || [];
            if (qualities.length) {
                const servers = qualities[0].serverList || [];
                if (servers.length) {
                    const serverData = await fetchAPI('/server/' + servers[0].serverId);
                    streamUrl = serverData?.url || '';
                }
            }

            if (anime) {
                addToHistory(animeSlug, anime.title, anime.poster, episodeSlug, episode.title);
            }

            let html = `
                <div class="player-container">
                    ${streamUrl ? `<iframe class="player-iframe" src="${streamUrl}" allowfullscreen></iframe>` : '<div style="color:white; text-align:center; padding:50px;">Stream tidak tersedia</div>'}
                </div>
                <div style="display:flex; gap:10px; margin:15px 0;">
                    <button class="genre-tag" style="background:gold; color:#000;" onclick="window.open('${streamUrl}','_blank')"><i class="fas fa-external-link-alt"></i> Buka di Browser</button>
                </div>
                <div style="background:#1f1f1f; padding:20px; border-radius:8px;">
                    <h2 style="color:gold;">${anime?.title || 'Anime'}</h2>
                    <p>${episode.title}</p>
                </div>
            `;

            if (anime?.episodeList) {
                html += '<div class="section-header"><i class="fas fa-list gold"></i> Episode Lain</div>';
                html += '<div class="episode-list">';
                anime.episodeList.forEach(ep => {
                    const isCurrent = ep.episodeId === episodeSlug;
                    html += `
                        <div class="episode-item" style="${isCurrent ? 'border-left:4px solid gold;' : ''}" onclick="${!isCurrent ? `navigateTo('episode', { episodeSlug: '${ep.episodeId}', animeSlug: '${animeSlug}' })` : ''}">
                            <div class="episode-number">${ep.eps}</div>
                            <div class="episode-title">${ep.title}</div>
                            ${isCurrent ? '<i class="fas fa-play" style="color:gold;"></i>' : ''}
                        </div>
                    `;
                });
                html += '</div>';
            }

            content.innerHTML = html;
        }

        // ==================== GENRE LIST ====================
        async function renderGenreList() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="shimmer-wrapper"></div>';
            const data = await fetchAPI('/genre/');
            const genres = data?.genreList || [];
            let html = '<div class="section-header"><i class="fas fa-tags gold"></i> Semua Genre</div>';
            html += '<div style="display:flex; flex-wrap:wrap; gap:10px;">';
            genres.forEach(g => {
                html += `<div class="genre-tag" style="padding:8px 16px; font-size:16px;" onclick="navigateTo('genre', { genreSlug: '${g.genreId}', genreName: '${g.title}' })">${g.title}</div>`;
            });
            html += '</div>';
            content.innerHTML = html;
        }

        async function renderGenreDetail(genreSlug, genreName) {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="shimmer-wrapper"></div>';
            const data = await fetchAPI('/genre/' + genreSlug);
            const list = data?.animeList || [];
            let html = `<div class="section-header"><i class="fas fa-tag gold"></i> Genre: ${genreName}</div>`;
            html += '<div class="anime-grid">';
            list.forEach(anime => {
                html += `<div class="anime-card" onclick="navigateTo('detail', { slug: '${anime.animeId}' })">
                    <img src="${anime.poster}"><div class="info"><div class="title">${anime.title}</div></div>
                </div>`;
            });
            html += '</div>';
            content.innerHTML = html;
        }

        // ==================== SCHEDULE ====================
        async function renderSchedule() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="shimmer-wrapper"></div>';
            const schedule = await fetchAPI('/schedule') || [];
            let html = '<div class="section-header"><i class="fas fa-calendar-alt gold"></i> Jadwal Rilis</div>';
            schedule.forEach(day => {
                html += `<div style="background:#1f1f1f; border-radius:8px; padding:15px; margin-bottom:20px;">`;
                html += `<h3 style="color:gold;">${day.day}</h3>`;
                html += `<div class="anime-grid">`;
                day.anime_list?.forEach(anime => {
                    html += `<div class="anime-card" onclick="navigateTo('detail', { slug: '${anime.slug}' })"><img src="${anime.poster}"><div class="info"><div class="title">${anime.title}</div></div></div>`;
                });
                html += `</div></div>`;
            });
            content.innerHTML = html;
        }

        // ==================== HISTORY ====================
        function renderHistory() {
            loadHistory();
            let html = '<div class="section-header"><i class="fas fa-history gold"></i> Watch History</div>';
            if (watchHistory.length === 0) {
                html += '<p>Belum ada history</p>';
            } else {
                html += '<div class="anime-grid">';
                watchHistory.forEach(item => {
                    html += `
                        <div class="anime-card" onclick="navigateTo('episode', { episodeSlug: '${item.episodeSlug}', animeSlug: '${item.animeSlug}' })">
                            <img src="${item.animePoster}">
                            <div class="info">
                                <div class="title">${item.animeTitle}</div>
                                <div class="meta">${item.episodeTitle || ''}</div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }
            document.getElementById('content').innerHTML = html;
        }

        // Inisialisasi
        loadHistory();
    </script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2248811225701494"
     crossorigin="anonymous"></script>
    
</body>
</html>
